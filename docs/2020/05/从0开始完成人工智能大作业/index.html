<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>
        ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š - masterençš„å¡«å‘ä¹‹æ—…
      </title>
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  
  <meta name="theme-color" content="#000000" />
  
  <meta http-equiv="window-target" content="_top" />
  
  
  <meta name="description" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š" />
  <meta name="generator" content="Hugo 0.69.0 with theme pure" />
  <title>ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š - masterençš„å¡«å‘ä¹‹æ—…</title>
  
  
  <link rel="stylesheet" href="https://masterenlu.github.io/blogSite/css/style.min.7dc20efbc53647d41aa9ddea0c48e59300223d084e66ea0cbe7c30bd88903acc.css">
  
  <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" async>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
  <meta property="og:title" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š" />
<meta property="og:description" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://masterenlu.github.io/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/" />
<meta property="article:published_time" content="2020-05-18T12:53:32+08:00" />
<meta property="article:modified_time" content="2020-05-18T12:53:32+08:00" /><meta property="og:see_also" content="https://masterenlu.github.io/blogSite/2020/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%BB%B6%E6%AF%94%E8%BE%83%E5%9D%91%E7%9A%84%E4%BA%8B/" /><meta property="og:see_also" content="https://masterenlu.github.io/blogSite/2020/04/windows-terminal%E7%9A%84%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/" /><meta property="og:see_also" content="https://masterenlu.github.io/blogSite/2020/04/%E4%B8%80%E4%B8%AAhugo-github-page%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E6%98%AF%E5%A6%82%E4%BD%95%E6%90%AD%E6%88%90%E7%9A%84/" />


<meta itemprop="name" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š">
<meta itemprop="description" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š">
<meta itemprop="datePublished" content="2020-05-18T12:53:32&#43;08:00" />
<meta itemprop="dateModified" content="2020-05-18T12:53:32&#43;08:00" />
<meta itemprop="wordCount" content="3208">



<meta itemprop="keywords" content="CNN,ResNet,å›¾åƒåˆ†ç±»,PyTorch," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š"/>
<meta name="twitter:description" content="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š"/>

  <!--[if lte IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
    <![endif]-->

  <!--[if lt IE 9]>
      <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->

</head>
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/masterenlu" target="_blank">
            <img class="img-circle img-rotate" src="https://masterenlu.github.io/blogSite/avatar.png" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">masteren</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">ä»ä¸æ‘¸é±¼</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="æœç´¢" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">Ã—</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/blogSite/">
                  <span class="menu-title">ä¸»é¡µ</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/blogSite/posts/">
                  <span class="menu-title">å½’æ¡£</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/blogSite/about/about">
                  <span class="menu-title">ç•™è¨€æ¿&amp;å…³äº</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">å…¬å‘Š</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>å·¦ä¸‹è§’çš„çƒå½¢é“¾æ¥å…¶å®æ˜¯æˆ‘çš„tg</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> <a href="/blogSite/categories">åˆ†ç±»</a></h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://masterenlu.github.io/blogSite/categories/%E6%89%BE%E4%B9%90%E5%AD%90/" class="category-list-link">æ‰¾ä¹å­</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://masterenlu.github.io/blogSite/categories/%E6%97%A5%E5%B8%B8/" class="category-list-link">æ—¥å¸¸</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://masterenlu.github.io/blogSite/categories/%E6%AD%A3%E7%BB%8F%E4%BA%8B/" class="category-list-link">æ­£ç»äº‹</a><span class="category-list-count">1</span></li>
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"><a href="/blogSite/tags">æ ‡ç­¾</a></h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/blog/" class="tag-list-link">blog</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/cnn/" class="tag-list-link">cnn</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/html/" class="tag-list-link">html</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/hugo/" class="tag-list-link">hugo</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/outlook/" class="tag-list-link">outlook</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/pytorch/" class="tag-list-link">pytorch</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/resnet/" class="tag-list-link">resnet</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/terminal/" class="tag-list-link">terminal</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/windows/" class="tag-list-link">windows</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/windows-terminal/" class="tag-list-link">windows-terminal</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/" class="tag-list-link">å›¾åƒåˆ†ç±»</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/%E6%B3%A8%E5%86%8C%E8%A1%A8/" class="tag-list-link">æ³¨å†Œè¡¨</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://masterenlu.github.io/blogSite/tags/%E9%82%AE%E7%AE%B1/" class="tag-list-link">é‚®ç®±</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://masterenlu.github.io/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/" class="title">ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-18 12:53:32 &#43;0800 CST" itemprop="datePublished">2020-05-18</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://masterenlu.github.io/blogSite/2020/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%BB%B6%E6%AF%94%E8%BE%83%E5%9D%91%E7%9A%84%E4%BA%8B/" class="title">è®°å½•ä¸€ä»¶æ¯”è¾ƒå‘çš„äº‹</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-05-06 11:17:47 &#43;0800 CST" itemprop="datePublished">2020-05-06</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://masterenlu.github.io/blogSite/2020/04/windows-terminal%E7%9A%84%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/" class="title">Windows Terminalçš„ç®€å•é…ç½®</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-04-22 09:42:49 &#43;0800 CST" itemprop="datePublished">2020-04-22</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://masterenlu.github.io/blogSite/2020/04/%E4%B8%80%E4%B8%AAhugo-github-page%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E6%98%AF%E5%A6%82%E4%BD%95%E6%90%AD%E6%88%90%E7%9A%84/" class="title">ä¸€ä¸ªhugo&#43;github pagesé™æ€åšå®¢æ˜¯å¦‚ä½•æ­æˆçš„</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-04-20 18:25:03 &#43;0800 CST" itemprop="datePublished">2020-04-20</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://masterenlu.github.io/blogSite/2019/03/pat-basic-level-practice-%E9%A2%98%E8%A7%A3/" class="title">PAT(Basic level)Practice é¢˜è§£</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2019-03-31 21:25:00 &#43;0800 CST" itemprop="datePublished">2019-03-31</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">æ–‡ç« ç›®å½•</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/"
    >ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://masterenlu.github.io/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/" class="article-date">
  <time datetime="2020-05-18 12:53:32 &#43;0800 CST" itemprop="datePublished">2020-05-18</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/blogSite/categories/%E6%AD%A3%E7%BB%8F%E4%BA%8B/"> æ­£ç»äº‹ </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/blogSite/tags/cnn/"> CNN </a>
    <a class="article-tag-link" href="/blogSite/tags/resnet/"> ResNet </a>
    <a class="article-tag-link" href="/blogSite/tags/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/"> å›¾åƒåˆ†ç±» </a>
    <a class="article-tag-link" href="/blogSite/tags/pytorch/"> PyTorch </a>
  </span>

	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>
        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/#comments"
            class="article-comment-link">è¯„è®º</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">å­—æ•°ç»Ÿè®¡: 3208å­—</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">é˜…è¯»æ—¶é•¿: 7åˆ† </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2>
<p>2020å¹´5æœˆ6æ—¥ï¼Œæœ€åä¸€èŠ‚äººå·¥æ™ºèƒ½è¯¾ä¸Šï¼Œè€å¸ˆå®£å¸ƒå°†æœŸæœ«è€ƒè¯•æ”¹æˆå¤§ä½œä¸šçš„å½¢å¼ï¼ˆå…¶å®ä¹‹å‰å°±è¯´è¿‡ï¼Œä½†æ˜¯å…·ä½“æ˜¯å“ªå¤©æˆ‘å¿˜äº†ï¼‰ï¼Œè¦æ±‚ä½¿ç”¨ cnn ç½‘ç»œå’Œ pytorch æ¡†æ¶å®Œæˆå¸ƒç½®çš„å‡ é¡¹ä»»åŠ¡ä¹‹ä¸€ã€‚</p>
<p>ç›´åˆ°è¿™ä¸€å¤©ï¼Œæˆ‘ä»¬æ‰çœŸæ­£äº†è§£äººå·¥æ™ºèƒ½å¯¼è®ºçš„çœŸæ­£å«ä¹‰ï¼Œä¸æ˜¯å…¥é—¨ï¼Œè€Œæ˜¯è‡ªå·±åŠ¨æ‰‹å†™å®é™…é¡¹ç›®ã€‚æ²¡åŠæ³•ï¼Œé›¶åŸºç¡€çš„æˆ‘åªèƒ½é€‰æ‹©ä¸€ä¸ªæœ€ç®€å•çš„å›¾ç‰‡åˆ†ç±»æ¥åšä¸€åšï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯è®°å½•ä¸€ä¸‹ï¼Œå¦‚æœä»¥åæœ‰éœ€è¦çš„è¯è¿˜å¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚</p>
<h2 id="å…³äº-cnn">å…³äº CNN</h2>
<p>é¦–å…ˆè¦åšçš„å°±æ˜¯äº†è§£éœ€è¦ç”¨åˆ°çš„æ¡†æ¶å’Œç½‘ç»œã€‚</p>
<p>è¦æ±‚ä½¿ç”¨ cnn ç½‘ç»œæ¥å®Œæˆä»»åŠ¡ï¼Œä½†æ˜¯ä¹‹å‰ä¸Šè¯¾åªè®²è¿‡ç¥ç»å…ƒç½‘ç»œï¼ˆnnï¼‰,æ‰€ä»¥è¿™é‡Œé¡ºæ‰‹å°±æ‰“å¼€äº†ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C">ç»´åŸºç™¾ç§‘</a></p>
<blockquote>
<p><strong>å·ç§¯ç¥ç»ç½‘ç»œ</strong>ï¼ˆConvolutional Neural Network, <strong>CNN</strong>ï¼‰æ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C">å‰é¦ˆç¥ç»ç½‘ç»œ</a>ï¼Œå®ƒçš„äººå·¥ç¥ç»å…ƒå¯ä»¥å“åº”ä¸€éƒ¨åˆ†è¦†ç›–èŒƒå›´å†…çš„å‘¨å›´å•å…ƒï¼Œ[<a href="https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C#cite_note-deeplearning-1">1]</a>å¯¹äºå¤§å‹å›¾åƒå¤„ç†æœ‰å‡ºè‰²è¡¨ç°ã€‚</p>
<p>å·ç§¯ç¥ç»ç½‘ç»œç”±ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯å±‚å’Œé¡¶ç«¯çš„å…¨è¿é€šå±‚ï¼ˆå¯¹åº”ç»å…¸çš„ç¥ç»ç½‘ç»œï¼‰ç»„æˆï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬å…³è”æƒé‡å’Œæ± åŒ–å±‚ï¼ˆpooling layerï¼‰ã€‚è¿™ä¸€ç»“æ„ä½¿å¾—å·ç§¯ç¥ç»ç½‘ç»œèƒ½å¤Ÿåˆ©ç”¨è¾“å…¥æ•°æ®çš„äºŒç»´ç»“æ„ã€‚ä¸å…¶ä»–æ·±åº¦å­¦ä¹ ç»“æ„ç›¸æ¯”ï¼Œå·ç§¯ç¥ç»ç½‘ç»œåœ¨å›¾åƒå’Œ<a href="https://zh.wikipedia.org/wiki/%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB">è¯­éŸ³è¯†åˆ«</a>æ–¹é¢èƒ½å¤Ÿç»™å‡ºæ›´å¥½çš„ç»“æœã€‚è¿™ä¸€æ¨¡å‹ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95">åå‘ä¼ æ’­ç®—æ³•</a>è¿›è¡Œè®­ç»ƒã€‚ç›¸æ¯”è¾ƒå…¶ä»–æ·±åº¦ã€å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå·ç§¯ç¥ç»ç½‘ç»œéœ€è¦è€ƒé‡çš„å‚æ•°æ›´å°‘ï¼Œä½¿ä¹‹æˆä¸ºä¸€ç§é¢‡å…·å¸å¼•åŠ›çš„æ·±åº¦å­¦ä¹ ç»“æ„[<a href="https://zh.wikipedia.org/wiki/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C#cite_note-STANCNN-2">2]</a>ã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªä½¿ç”¨å·ç§¯è¿ç®—æ¥å¤„ç†æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚åŒ…æ‹¬å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ã€‚</p>
<p>åœ¨æ¯ä¸ªå·ç§¯å±‚ä¸Šéƒ½ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯æ ¸ï¼ˆ$kernel$ï¼‰æ¥å¯¹äºŒç»´åŒ–çš„æ•°æ®è¿›è¡Œæ‰«æå’Œå·ç§¯è¿ç®—ã€‚åœ¨æ± åŒ–å±‚ä¸Šä¼šå¯¹å·ç§¯åçš„æ•°æ®è¿›è¡Œå‹ç¼©ã€‚æœ€åå°±æ˜¯æ™®é€šç¥ç»å…ƒç½‘ç»œçš„å…¨è¿æ¥å±‚ã€‚</p>
<p>åœ¨å·ç§¯æ“ä½œæ—¶ï¼Œå·ç§¯æ ¸ä¼šå¯¹ $kernel_size$ å†…çš„æ•°æ®æ¯ $stride$ ä¸€æ¬¡è¿›è¡Œå·ç§¯è¿ç®—ã€‚ä½†æ˜¯è¿™æ ·æ¯æ¬¡è¿ç®—å›¾ç‰‡éƒ½ä¼šå˜å°ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¼•å…¥äº† $padding$ï¼Œå³åœ¨åŸæ•°æ®å‘¨å›´åŠ ä¸Š $padding$ å±‚çš„ $0$ æ•°æ®ã€‚</p>
<p>ç½‘ä¸Šå…³äº CNN çš„ä»‹ç»æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä¸å†åºŸè¯ï¼Œæœ‰æ¡ä»¶çš„å¯ä»¥çœ‹çœ‹<a href="https://morvanzhou.github.io/tutorials/machine-learning/torch/4-01-A-CNN/">ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ CNN (Convolutional Neural Network)</a></p>
<h2 id="æ•°æ®é›†å‡†å¤‡">æ•°æ®é›†å‡†å¤‡</h2>
<p>è¿™é‡Œå›½å†…äº¤é€šæ ‡è¯†åˆ†ç±»æ•°æ®é›†æ¯”è¾ƒå°‘ï¼Œæˆ‘è¿™é‡Œåœ¨ <a href="http://www.nlpr.ia.ac.cn/pal/trafficdata/recognition.html">Chinese Traffic Sign Database</a> ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œå¯æƒœçš„æ˜¯æ•°æ®é›†æ¯”è¾ƒå°ï¼Œä¾›è®­ç»ƒçš„å›¾ç‰‡åªæœ‰ 4k+ å¼ ï¼Œè€Œä¸”åˆ†å¸ƒä¸å‡åŒ€ï¼Œ58 ä¸ªåˆ†ç±»ï¼Œæœ‰äº›åˆ†ç±»åªæœ‰å‡ åå¼ è®­ç»ƒå›¾ã€‚åªèƒ½åæœŸè¿›è¡Œæ•°æ®å¢å¼ºäº†ã€‚</p>
<p>ä¸‹è½½ä¸‹æ¥æ•°æ®é›†å’Œæ ‡è®°æ–‡ä»¶ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å°†æ ‡è®°æ–‡ä»¶çš„æ ¼å¼æ”¹æˆäº†</p>
<pre><code>path/fileName class
</code></pre>
<p>çš„æ ¼å¼ã€‚</p>
<p>ä» <code>torch.utils.data</code> å¯¼å…¥ <code>Dataset</code>ï¼Œæ ¹æ®<a href="https://pytorch.org/docs/stable/data.html">å®˜æ–¹æ–‡æ¡£</a>ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„æ•°æ®é›†æœ‰ä¸¤ç§ï¼Œ<code>map-style datasets</code> å’Œ <code>iterable-style datasets</code>ï¼Œè¿™é‡Œé€‰æ‹©äº†ç¬¬ä¸€ç§ï¼Œç„¶ååˆ›å»ºç»§æ‰¿è‡ª <code>Dataset</code> çš„æ•°æ®é›†ç±»ï¼Œåˆ›å»ºçš„æ•°æ®é›†åº”è¯¥åŒ…æ‹¬ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="language-python">class trafficDataset(Dataset):
    def __init__(self, label_file_path, train=True):
    def __getitem__(self, index):
    def __len__(self):
</code></pre>
<p>åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œéœ€è¦è¯»å–å›¾ç‰‡å’Œå…¶åˆ†ç±»ï¼Œåªéœ€è¯»å–æ ‡è¯†æ–‡ä»¶ä¸­çš„å›¾ç‰‡è·¯å¾„å’Œåˆ†ç±»å³å¯</p>
<pre><code class="language-python">def __init__(self, label_file_path, train=True):
    f = open(label_file_path, 'r')
    self.data = list(map(lambda line: line.strip().split(' '), f)) # è¯»å–æ–‡ä»¶å’Œåˆ†ç±»
    self.train = train # æ ‡è®°æ˜¯å¦ç”¨äºè®­ç»ƒ
</code></pre>
<p>åœ¨ <code>__getitem__</code> æ–¹æ³•ä¸­ï¼Œéœ€è¦æ ¹æ®ç»™çš„ä¸‹æ ‡æ¥è¯»å–é€‰æ‹©çš„æ•°æ®ï¼Œè¿™é‡Œç”±äºä¹‹å‰è½½å…¥çš„ <code>data</code> æ˜¯å›¾ç‰‡è·¯å¾„å’Œåˆ†ç±»ï¼Œæ‰€ä»¥ <code>path, label = self.data[index]</code>ï¼Œç„¶åæ ¹æ®æ˜¯å¦ç”¨äºè®­ç»ƒå¯¹å›¾åƒåˆ†åˆ«å¤„ç†ã€‚è¿™é‡Œçš„å›¾ç‰‡å¤„ç†å’Œæ•°æ®å¢å¼ºéœ€è¦ç”¨åˆ° <code>torchvision</code> ä¸­çš„ <code>transforms</code> å’Œ <code>PIL</code> ä¸­çš„ <code>Image</code>ã€‚</p>
<pre><code class="language-python">if self.train:
    # è®­ç»ƒé›†æ‰§è¡Œæ•°æ®å¢å¼º
    img = transforms.Compose([transforms.Resize((256, 256)), # ç»Ÿä¸€å°ºå¯¸
                              transforms.RandomRotation([-30, 30]), # åœ¨-30åº¦åˆ°30åº¦ä¹‹é—´éšæœºæ—‹è½¬
                              transforms.RandomGrayscale(0.3), # ä»¥0.3çš„æ¦‚ç‡å°†å›¾ç‰‡è½¬ä¸ºç°åº¦
                              transforms.ColorJitter(brightness=0.5, contrast=0.5), # éšæœºæ”¹å˜å›¾ç‰‡çš„äº®åº¦é¥±å’Œåº¦
                              transforms.ToTensor(), # å°†å›¾ç‰‡è½¬ä¸º Tensor æ ¼å¼
                              transforms.Normalize((0.485, 0.456, 0.406), (0.229, 0.224, 0.225)) # å›¾ç‰‡å½’ä¸€åŒ– 
                             ])(Image.open(path).convert('RGB'))
else:
    # æµ‹è¯•é›†ä¸æ‰§è¡Œ
    img = transforms.Compose([transforms.Resize((256, 256)),
                              transforms.ToTensor(),
                              transforms.Normalize((0.485, 0.456, 0.406), (0.229, 0.224, 0.225))
                             ])(Image.open(path).convert('RGB'))
</code></pre>
<p>ç„¶åå°†è·å¾—çš„ <code>img</code> å’Œ <code>lable</code> ä½œä¸ºè¿”å›å€¼ã€‚</p>
<p><code>__len__</code> æ–¹æ³•ä¸ºè·å–æ•°æ®é›†é•¿åº¦ã€‚</p>
<h2 id="ä½¿ç”¨-pytorch-æ„å»ºè‡ªå·±çš„-cnn-ç½‘ç»œ">ä½¿ç”¨ pytorch æ„å»ºè‡ªå·±çš„ CNN ç½‘ç»œ</h2>
<p>æ„å»ºæ•°æ®é›†ä¹‹åå°±æ˜¯å…³é”®çš„ CNN ç½‘ç»œçš„æ„å»ºï¼Œç”±äºåŒæ ·æ˜¯å›¾å½¢åˆ†ç±»ï¼Œè¿™é‡Œç½‘ç»œçš„æ„å»ºå¯ä»¥å‚è€ƒç½‘ä¸Šä¸€äº›ç»å…¸çš„ CNN ç½‘ç»œï¼Œæ¯”å¦‚ LeNet-5 ç½‘ç»œã€‚</p>
<p>è¦æ„å»ºç¥ç»å…ƒç½‘ç»œï¼Œé¦–å…ˆå¯¼å…¥ <code>torch</code> ä¸­çš„ <code>nn</code>ï¼Œç„¶åç»§æ‰¿ <code>nn.Module</code> æ„å»ºè‡ªå·±çš„ç¥ç»å…ƒç½‘ç»œç±»ï¼Œåº”è¯¥åŒ…å«ä¸¤ä¸ªæ–¹æ³•</p>
<pre><code class="language-python">class cnn(nn.Module):
    def __init__(self): # åˆå§‹åŒ–
        super(cnn, self).__init__()
	def forward(self, x): # æ­£å‘ä¼ æ’­
</code></pre>
<p>æŒ‰ç…§ä¸Šé¢è¯´çš„ä¸‰ä¸ªå±‚æ¬¡ï¼Œåœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ä¾æ¬¡æ·»åŠ å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ã€‚LeNet-5 ç½‘ç»œé™¤äº†è¿™ä¸‰ä¸ªä¹‹å¤–è¿˜åŒ…æ‹¬ä¸€ä¸ªæ¿€æ´»å±‚ã€‚</p>
<pre><code class="language-python">class cnn(nn.Module):
    def __init__(self):
        super(cnn, self).__init__()
		self.conv1 = nn.Conv2d(in_channels=3, # å·ç§¯å±‚
                               out_channels=16,
                               kernel_size=5,
                               stride=1,
                               padding=2) 
        self.relu = nn.ReLU(inplace=True) # æ¿€æ´»å±‚
        self.maxpool = nn.MaxPool2d(kernel_size=2) # æ± åŒ–å±‚
        self.fc = nn.Liner(16*128*128, 58) # å…¨è¿æ¥å±‚
	def forward(self, x):
        x = self.conv1(x)
        x = self.relu(x)
        x = self.maxpool(x)
        x = x.reshape(x.size(0), -1)
        x = self.fc(x)
        return x
</code></pre>
<p>ä¸€ä¸ªç®€å•çš„ LeNet-5 ç½‘ç»œå°±æ­å»ºå®Œæˆäº†ã€‚åœ¨è¿™ä¸ªç½‘ç»œé‡Œåªè¿›è¡Œäº†ä¸€æ¬¡å·ç§¯ï¼Œå®é™…ä¸Šéœ€è¦ç”¨åˆ°çš„å·ç§¯å±‚å¯èƒ½æ›´å¤šï¼Œå¯ä»¥æ ¹æ®ä¸åŒéœ€æ±‚æ¥æ·»åŠ ã€‚</p>
<p>åŒæ—¶ä¸ºé¿å…è¿‡æ‹Ÿåˆé€šå¸¸ä¹Ÿä¼šæ·»åŠ  <code>dropout</code> ç­‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ <code>BN</code> å’Œ <code>dropout</code> ä¸€èˆ¬ä¸å¹¶ç”¨ï¼Œä¼¼ä¹æ˜¯ä¼šå¯¼è‡´æ–¹å·®åç§»ã€‚</p>
<p>æœ‰å…³äºå·ç§¯å±‚çš„è¾“å…¥å’Œè¾“å‡ºå°ºå¯¸é—®é¢˜ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¼ï¼Œå‡è®¾ä¸€äº›å˜é‡ $$H_i, W_i, D_i, H_o, W_o, D_o$$ åˆ†åˆ«ä¸ºè¾“å…¥æ—¶çš„é•¿å®½æ·±å’Œè¾“å‡ºæ—¶çš„é•¿å®½æ·±ï¼Œ$$C_i, C_o, K, S, P$$ åˆ†åˆ«ä¸ºå·ç§¯å±‚çš„äº”ä¸ªå‚æ•°ã€‚</p>
<p>æœ‰ï¼š
$$
H_o = \left\lfloor\frac{H_i-K+2P}{S}\right\rfloor+1 \<br>
W_o = \left\lfloor\frac{W_i-K+2P}{S}\right\rfloor+1 \<br>
D_o = \left\lfloor\frac{D_i-K+2P}{S}\right\rfloor+1
$$
æ± åŒ–å±‚ä½¿ç”¨åŒä¸€ä¸ªå…¬å¼ã€‚</p>
<h2 id="è®­ç»ƒéƒ¨åˆ†">è®­ç»ƒéƒ¨åˆ†</h2>
<p>åœ¨æ•°æ®é›†å’Œç¥ç»ç½‘ç»œéƒ½æ­å»ºå®Œæˆä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹è®­ç»ƒè‡ªå·±çš„æ¨¡å‹äº†ã€‚</p>
<p>å¼€å§‹ä¹‹å‰éœ€è¦åˆ›å»ºæ•°æ®é›†å¯¹è±¡</p>
<pre><code class="language-python">full_data = trafficDataset(label_file_path='./Train/label_train.txt', train=True) # æŒ‡å®šè®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ•°æ®
train_size = int(0.9 * len(full_data)) 
vali_size = len(full_data) - train_size
# å°†è®­ç»ƒé›†çš„ä¸€éƒ¨åˆ†æ‹¿å‡ºæ¥ç”¨åšéªŒè¯
train_data, vali_data = torch.utils.data.random_split(full_data, [train_size, vali_size])

train_loader = DataLoader(train_data, batch_size=16, shuffle=True) # æ¯16ä¸ªä¸€æ‰¹è¿›è¡Œè®­ç»ƒï¼Œé¡ºåºéšæœº
vali_loader = DataLoader(vali_data, batch_size=16, shuffle=True)
</code></pre>
<blockquote>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ GPU è¿›è¡Œè®­ç»ƒï¼Œéœ€è¦æŒ‡å®šæ¨¡å‹å¯¹è±¡å’Œæ•°æ®ä½¿ç”¨çš„è®¾å¤‡</p>
<pre><code class="language-python">device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')
model = cnn().to(device)
</code></pre>
</blockquote>
<p>ç„¶åæŒ‡å®šç”¨äºåå‘ä¼ æ’­çš„ <code>loss</code> æ–¹æ³•ã€ä¼˜åŒ–å™¨ã€å­¦ä¹ ç‡å’Œ <code>epoch</code> ç­‰æ•°æ®ã€‚</p>
<pre><code class="language-python">EPOCH = 50
LEARNING_RATE = 0.001 # å­¦ä¹ ç‡
loss_func = nn.CrossEntropyLoss() # äº¤å‰ç†µ
optimizer = torch.optim.AdamW(model.parameters(), lr=LEARNING_RATE, amsgrad=False, weight_decay=0.0005)
</code></pre>
<blockquote>
<p>å¦‚æœéœ€è¦æŒ‰ <code>epoch</code> è®¾ç½®åŠ¨æ€å­¦ä¹ ç‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>torch.optim.lr_scheduler</code> ä¸­çš„æ–¹æ³•æ¥è®¾ç½®è¡°å‡ç‡ï¼Œç„¶ååœ¨æ¯ä¸ª <code>epoch</code> ç»“æŸåè¿›è¡Œ <code>scheduler.step()</code> æ¥æ”¹å˜å­¦ä¹ ç‡ã€‚</p>
<p>âš  <code>scheduler</code> æ˜¯ <code>torch.optim.lr_scheduler.bulabula</code> çš„å¯¹è±¡</p>
</blockquote>
<p>ç„¶åå°±å¯ä»¥å¼€å§‹è®­ç»ƒäº†</p>
<pre><code class="language-python">for epoch in range(EPOCH):
    torch.cuda.empty_cache()
    for step, (images, labels) in enumerate(train_loader):
        images = images.to(device) # å°†æ•°æ®é€åˆ°æŒ‡å®šè®¾å¤‡
        labels = labels.to(device)

        outputs = model(images) # è·å–é¢„æµ‹å€¼
        loss = loss_func(outputs, labels) # è·å–äº¤å‰ç†µ

        optimizer.zero_grad() # æ¢¯åº¦å½’é›¶
        loss.backward() # åå‘ä¼ æ’­
        optimizer.step() # æ¢¯åº¦æ›´æ–°
        # æ¯20æ¬¡è®­ç»ƒè¾“å‡ºä¸€æ¬¡
        if step % 20 == 0:
            print('Epoch [{}/{}], Step [{}/{}], Loss: {:.7f}'.format(epoch + 1, EPOCH, step + 1, total_step,
                                                                         loss.item()))
</code></pre>
<p>å¯ä»¥ä½¿ç”¨ç±»ä¼¼æµ‹è¯•çš„æ–¹æ³•å¯ä»¥åœ¨æ¯ä¸ª <code>epoch</code> åå¯¹éªŒè¯é›†è¿›è¡Œä¸€æ¬¡éªŒè¯ã€‚</p>
<p>è®­ç»ƒç»“æŸä¹‹åå¯ä»¥ä½¿ç”¨ <code>torch.save(model.state_dict(), 'model.pt')</code> æ¥å°†è®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜åˆ°æœ¬åœ°ï¼Œä»¥ä¾¿æµ‹è¯•ã€‚</p>
<h2 id="æµ‹è¯•éƒ¨åˆ†">æµ‹è¯•éƒ¨åˆ†</h2>
<p>å¦‚æœæœ‰ä¿å­˜çš„æ¨¡å‹ï¼Œå…ˆä½¿ç”¨åˆ›å»ºä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>model.load_state_dict(torch.load('model.pt'))</code> æ¥åŠ è½½ä¹‹å‰ä¿å­˜çš„æ¨¡å‹ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ­£å¼å¼€å§‹æµ‹è¯•ä¹‹å‰ï¼Œè¦ä½¿ç”¨ <code>model.eval()</code> å…ˆå°†æ¨¡å‹å¯¹è±¡çš„æ¨¡å¼æ”¹æˆè¯„ä¼°ã€‚</p>
<pre><code class="language-python">for images, labels in test_loader:
    images, labels = images.to(device), labels.to(device)
    with torch.no_grad():
        outputs = model(images) # è·å–é¢„æµ‹
        maxk = max((1, 5))
        labels_resize = labels.view(-1, 1)
        _, predicted = outputs.topk(maxk, 1, True, True) # è·å–å¯èƒ½æ€§æœ€å¤§çš„5ä¸ªç±»åˆ«
        correct += torch.eq(predicted, labels_resize).sum().item()
        total += labels.size(0)
</code></pre>
<p>è¿™é‡Œé‡‡ç”¨ top-5 çš„é¢„æµ‹æ–¹å¼æ¥é¢„æµ‹ç±»åˆ«ã€‚</p>
<h2 id="ç¬¬ä¸€ä¸ªæ¨¡å‹">ç¬¬ä¸€ä¸ªæ¨¡å‹</h2>
<p>ç¬¬ä¸€ä¸ªæ¨¡å‹ç”¨äº†4ä¸ªå·ç§¯å±‚ã€æ¿€æ´»å±‚ã€æ± åŒ–å±‚å’Œä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œæ²¡æœ‰æ•°æ®å¢å¼ºã€‚åœ¨å­¦ä¹ ç‡ 0.01 çš„æƒ…å†µä¸‹ä½¿ç”¨ Adam ä¼˜åŒ–å™¨è·‘äº† 50 ä¸ª epochï¼Œç»“æœå¹¶ä¸ç†æƒ³ï¼Œå¤§æ¦‚åªæœ‰50å·¦å³çš„æ­£ç¡®ç‡ã€‚</p>
<p>åœ¨åé¢å¯¹è®­ç»ƒé›†è¿›è¡Œæ•°æ®å¢å¼ºåï¼Œæ­£ç¡®ç‡æé«˜åˆ° 80 ä»¥ä¸Šï¼Œä½†æ˜¯ä¼¼ä¹ f1 åˆ†æ•°ä¸é«˜ï¼Œè¿™å¯æŠŠæˆ‘è¿™ä¸ªæ²¡ç»éªŒçš„ğŸ‘¶ğŸ‘¶æ€¥åäº†ã€‚</p>
<p>äºæ˜¯ï¼Œåœ¨å¤šæ–¹å’¨è¯¢å’Œèˆå‹å»ºè®®ä¸‹ï¼Œæˆ‘å°†æˆ‘çš„ CNN ç½‘ç»œæ”¹ä¸ºäº† ResNetã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯-resnet">ä»€ä¹ˆæ˜¯ ResNet</h2>
<p>æ·±åº¦æ®‹å·®ç½‘ç»œï¼ˆDeep residual network, ResNetï¼‰æ˜¯ç”±ä½•å‡¯æ˜å›¢é˜Ÿåœ¨2015å¹´æå‡ºçš„ä¸€ç§å·ç§¯ç¥ç»ç½‘ç»œã€‚å…¶ä½¿ç”¨æ®‹å·®å­¦ä¹ çš„æ–¹å¼æ¥è§£å†³æ·±å±‚ç½‘ç»œé€€åŒ–çš„é—®é¢˜ã€‚</p>
<p><img src="https://masterenlu.github.io/blogSite/img/%E6%AE%8B%E5%B7%AE%E5%AD%A6%E4%B9%A0.png" alt="æ®‹å·®å­¦ä¹ å•å…ƒ"></p>
<p>å°†è¾“å…¥ $x$ çš„ç‰¹å¾è®°ä¸º $H(x)$ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ª $x$ï¼Œ æ®‹å·®ä¸º $F(x)=H(x)-x$ï¼Œé‚£ä¹ˆè¿™ä¸ªç‰¹å¾å°±æ˜¯ $H(x)=F(x)+x$ã€‚</p>
<p>ResNet å‚è€ƒå¹¶ä¿®æ”¹äº† VGG19 çš„ç½‘ç»œç»“æ„ï¼ŒåŠ å…¥äº†æ®‹å·®å•å…ƒã€‚</p>
<p>å…·ä½“åœ¨<a href="https://arxiv.org/abs/1512.03385">è®ºæ–‡</a>é‡Œå¯ä»¥çœ‹~~ï¼ˆæ‡’å¾—å†™äº†~~ã€‚</p>
<h2 id="resnet-ç½‘ç»œçš„æ­å»º">ResNet ç½‘ç»œçš„æ­å»º</h2>
<h3 id="pytorch-å®˜æ–¹å®ç°">pytorch å®˜æ–¹å®ç°</h3>
<p>åœ¨ pytorch å®˜æ–¹åº“é‡Œæœ‰ ResNet çš„å®ç°ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‚ç…§ä¸€ä¸‹ï¼Œæºç åœ¨ <a href="https://github.com/pytorch/vision/blob/master/torchvision/models/resnet.py">Github</a> ä¸Šå¯ä»¥æ‰¾åˆ°ã€‚</p>
<h3 id="è‡ªå®šä¹‰æ­å»º">è‡ªå®šä¹‰æ­å»º</h3>
<p>è¿™é‡Œä¸»è¦æ˜¯ copy çš„å®˜æ–¹çš„ä»£ç ï¼Œç”±äºåªç”¨åˆ°äº† resnet50ï¼Œæ‰€ä»¥æ®‹å·®å—å°±åªè®¾ç½®äº†ä¸€ä¸ªï¼Œå‚æ•°ä¹Ÿå–æ¶ˆæ‰äº†ã€‚</p>
<h2 id="ç¬¬äºŒä¸ªæ¨¡å‹">ç¬¬äºŒä¸ªæ¨¡å‹</h2>
<p>åœ¨æ”¹ä¸º ResNet ç½‘ç»œä¹‹åï¼Œ0.001 å­¦ä¹ ç‡ç”¨ adamw è·‘äº† 15 ä¸ªepochï¼Œç»“æœå¦‚å›¾</p>
<p><img src="https://masterenlu.github.io/blogSite/img/%E6%A8%A1%E5%9E%8B%E4%BA%8C%E5%88%86%E6%95%B0.png" alt="æ¨¡å‹äºŒåˆ†æ•°"></p>
<p>![æ¨¡å‹äºŒloss](<a href="https://masterenlu.github.io/blogSite/img/">https://masterenlu.github.io/blogSite/img/</a>æ¨¡å‹äºŒ loss.png)</p>
<p>æµ‹è¯•é›†å‡†ç¡®ç‡å¯ä»¥åˆ°92ï¼Œä½†æ˜¯è¿™ä¸ª loss æ³¢åŠ¨æœ‰ç‚¹å¤¸å¼ ï¼Œäºæ˜¯æˆ‘å°†å­¦ä¹ ç‡æ”¹æˆ 0.01ï¼Œè·‘äº† 50 ä¸ª epochï¼Œç»“æœå¦‚å›¾</p>
<p>![AdamW åˆ†æ•°](<a href="https://masterenlu.github.io/blogSite/img/AdamW">https://masterenlu.github.io/blogSite/img/AdamW</a> Score.png)</p>
<p>![SGD åˆ†æ•°](<a href="https://masterenlu.github.io/blogSite/img/SGD">https://masterenlu.github.io/blogSite/img/SGD</a> Score.png)</p>
<p>æ„Ÿè§‰è¿˜æ˜¯å¯ä»¥çš„ï¼Œè‡³å°‘ä½œä¸ºæˆ‘ç¬¬ä¸€ä¸ª AI æ¨¡å‹æ¥è¯´ï¼Œåº”è¯¥ç®—æ˜¯æ¯”è¾ƒæˆåŠŸäº†ã€‚</p>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<p>çœŸæ­£çš„ä»é›¶å¼€å§‹åšä¸€ä¸ªä¸œè¥¿ï¼Œæ€»å…±ç®—ä¸‹æ¥å¤§æ¦‚èŠ±äº†ä¸¤ä¸ªå‘¨æœ«æ¥å®Œæˆè¿™ä¸ªæ¨¡å‹ï¼ŒæœŸé—´ç‹‚å¬ Aimerï¼Œå·²ç»æ²‰è¿·äºè¿™ä¸ªç”œç¾çš„æ—…äººã€‚</p>
<p>ä»çš„æ¥è¯´æ„Ÿè§‰è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œå¥½æ­¹å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿~~ï¼ˆæŒ‡ç‹‚å¬ Aimer~~ï¼Œæ¯”åœ¨å®¶é—²ç€æ‘¸é±¼å¼ºã€‚</p>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li>
      <strong>åŸåˆ›å†…å®¹ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„</strong>
    </li>
    <li class="post-copyright-link ">
      <strong>æœ¬æ–‡é“¾æ¥: </strong>
      <a href="https://masterenlu.github.io/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/" title="ä»é›¶å¼€å§‹å®Œæˆäººå·¥æ™ºèƒ½å¤§ä½œä¸š" target="_blank" rel="external">https://masterenlu.github.io/blogSite/2020/05/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AE%8C%E6%88%90%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E4%BD%9C%E4%B8%9A/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Licenseï¼š</strong><a href="http://creativecommons.org/licenses/by-sa/2.5/deed.zh" target="_blank" rel="external">CC BY-SA 2.5</a>
    </li>
  </ul>
</blockquote>

    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://masterenlu.github.io/blogSite/2020/05/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%BB%B6%E6%AF%94%E8%BE%83%E5%9D%91%E7%9A%84%E4%BA%8B/" title="è®°å½•ä¸€ä»¶æ¯”è¾ƒå‘çš„äº‹"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="true"
                    title="æ–‡ç« ç›®å½•" role="button">
                    <span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
        </div>
    </div>
</nav>

</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/masterenlu" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://masterenlu.github.io/blogSite/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
    <li><a href="https://t.me/masterenlu" target="_blank" title="social-media" data-toggle=tooltip data-placement=top >
            <i class="icon icon-social-media"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2018  -
    2020
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://masterenlu.github.io/blogSite/js/application.min.bdeb64b910570b6c41badc6a05b7afb0c8ad9efd8525de3c7257d59e786326a3.js"></script>
<script src="https://masterenlu.github.io/blogSite/js/plugin.min.51ff8c7317566f82259170fa36e09c4493adc9b9378b427a01ad3f017ebac7dd.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'æ–‡ç« ',
                PAGES: 'é¡µé¢',
                CATEGORIES: 'åˆ†ç±»',
                TAGS: 'æ ‡ç­¾',
                UNTITLED: '(æœªå‘½å)',
            },
            ROOT_URL: 'https:\/\/masterenlu.github.io\/blogSite\/',
            CONTENT_URL: 'https:\/\/masterenlu.github.io\/blogSite\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://masterenlu.github.io/blogSite/js/insight.min.a343cd9a5a7698336b28ef3a7c16a3a1b1d2d5fb17dc8ed04022bbe08cc5459073a15bdafa3a8a58cdd56080784bdd69fa70b1ae8597565c799c57ed00f0e120.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://cdn.jsdelivr.net/npm/gitalk@1.4.0/dist/gitalk.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '309baa6c832ef5efe449',
        clientSecret: 'a76235be660016976d58a835cac77e3fb8dff763',
        repo: 'blogSite',
        owner: 'masterenlu',
        admin: ['masterenlu'],
        id: md5(location.pathname),
        distractionFreeMode: true
    });
    gitalk.render('comments');
</script>

  </body>
</html>
